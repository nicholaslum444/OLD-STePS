<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/css/main.css">

    <script src="/js/jquery-2.1.3.min.js"></script>
    <script src="/js/bootstrap.js"></script>
    <script src="/js/main.js"></script>

    <title>STePS</title>

</head>

<body>
    
    <nav class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/index.html">STePs</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <div class="navbar-right"> <!--align right-->
            <ul class="nav navbar-nav">
              <li><a href="/modules">Modules</a></li>
              <li><a href="?">Sign out</a></li>
            </ul>
          </div>
        </div><!--/.navbar-collapse -->
      </div>
    </nav>

    <div class="container">
        
        <div class="row">
        <h2>List of Projects</h2>
        <!--List of projects that student is registered under -->
        <p id="results"></p>
        <div class="col-md-6">
          <div class="panel panel-default">
            <div class="panel-body">
             <a href="/student/project">Module</a> 
           </div>
         </div>
       </div><!--End md-6-->

       <div class="col-md-6">
        <form class="form" action="/student/new-project">          
          <div class="form-group">
            <input type="hidden" class="form-control" id="registerProject">
          </div>
          <button type="submit" class="btn btn-default">Sign Up</button>
        </form>
      </div>

    </div>   
    <hr>
        <footer>
            <p>&copy; Website for STePS</p>
        </footer>

    </div> <!-- End of container -->
    <script>
    // THIS CODE POSTS THE TOKEN (RECEIVED FROM IVLE) TO THE SERVER FOR VERIFICATION
    // THE SERVER WILL START THE SESSION FOR THE USER IF THE TOKEN IS VERIFIED
    (function() {
        console.log("Postman is starting...");

        var postObj = {};

            // getUrlparam is a custom method, check source in the jquery.js
            postObj["token"] = $.getUrlParam("token");

            console.log(postObj);

            $.post(
                // post to this url to "login" the user to our servers.
                "/api/v1/user/student/login.php",

                postObj, // the obj containing the token

                // this function processes the return data
                function(data) {
                    // add steps to process the data received from the server
                    console.log(data);
                    $("#result").html(JSON.stringify(data));
                    // recommended step: store the token in the localstorage.
                    // the token may be used to verify the session of the user.

                    // all done
                    console.log("Postman is done!");
                });

            console.log("Postman has sent your data!");
        })();
    </script>
</body>

</html>
